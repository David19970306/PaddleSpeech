#edit-mode: -*- python -*-
#coding:gbk

WORKROOT('../')

#gcc version
GCC('gcc82')

# CPU Inference
CXXFLAGS('-std=c++11 -Os -g -pipe -W -Wall -fPIC -Wno-error')
LDFLAGS('-pthread -lrt -lm -lcrypt -ldl -lz')


# compile the fastdeploy and load the lib and include
Directory("fdlib")
INCPATHS("fdlib/include")
LIBS(GLOB("fdlib/lib/*.so*"))

INCPATHS('$INC')
PROTOFLAGS('-I.')
protos_source = GLOB('../proto/*.proto')
# load paraformer related lib
INCPATHS(".")
LIBS(GLOB("lib/*.a"))
# Application("asrcpu", Sources("main.cc"))
Application("asrcpuclient", Sources("client.cc"))
Application("asrcpuserver", Sources(protos_source, "server.cpp", "Audio.cpp", GLOB("webrtc/common_audio/signal_processing/*.c webrtc/common_audio/vad/*.c webrtc/rtc_base/checks.cc webrtc/common_audio/third_party/spl_sqrt_floor/*.c")))
